<div class="main-wrapper d-flex flex-column">
  <div style="height: 60%">
    <mgl-map
      [style]="'mapbox://styles/mafahes/ck7ytniby1cm81jlktlfxfuuh'"
      [zoom]="[9]"
      (move)="onMapChange($event)"
      (load)="onMapLoad($event)"
      [center]="[37.622887, 55.753283]"
    >
      <ng-container *ngFor="let item of coord">
        <mgl-marker
          #myMarker
          [lngLat]="[item.longitude, item.latitude]"
        >
          <img src="assets/images/car.png" [style.transform]="'rotate(' + (item.heading - bearing) + 'deg)'"/>
        </mgl-marker>
        <mgl-popup [marker]="myMarker">
          <div class="popup">
            <span>{{item.brigade.car.code}}</span>
            <span>Бригада №{{item.brigade.id}}</span>
            <span>Водитель: -</span>
            <span>Санитар: -</span>
            <div class="status">
              <span>бригада в пути</span>
            </div>
          </div>
        </mgl-popup>
      </ng-container>
    </mgl-map>
  </div>
  <div style="height: 40%; overflow-y: auto; max-height: 100%" class="pt-4">
    <div class="container-fluid">
      <div class="row pb-3">
        <div class="col-12 d-flex flex-row align-items-center" style="gap: 20px">
          <span class="title">Бригады на карте</span>
          <button routerLink="/dispatcher/brigade/new">Создать</button>
        </div>
      </div>
    </div>
    <div *ngFor="let i of brigade" [routerLink]="'/dispatcher/brigade/' + i.id" class="item px-3 d-flex flex-row">
      <div class="w-25">
        <span>{{i.name}}</span>
      </div>
      <div class="w-25">
        <span>Санитар: {{i?.drivers | brigadeTableHelper: 'drivers'}}</span>
      </div>
      <div class="w-25">
        <span>{{i?.car?.code || ''}}</span>
      </div>
      <div class="w-25">
        <span>{{i?.state | brigadeTableHelper: 'status'}}</span>
      </div>
    </div>
  </div>
</div>
